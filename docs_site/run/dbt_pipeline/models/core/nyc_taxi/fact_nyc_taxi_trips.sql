-- back compat for old kwarg name
  
  begin;
    
        
            
	    
	    
            
        
    

    

    merge into ANALYTICS_DEV.RAW_CORE.fact_nyc_taxi_trips as DBT_INTERNAL_DEST
        using ANALYTICS_DEV.RAW_CORE.fact_nyc_taxi_trips__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.trip_sk = DBT_INTERNAL_DEST.trip_sk))

    
    when matched then update set
        "TRIP_SK" = DBT_INTERNAL_SOURCE."TRIP_SK","SERVICE_TYPE" = DBT_INTERNAL_SOURCE."SERVICE_TYPE","PICKUP_TIMESTAMP" = DBT_INTERNAL_SOURCE."PICKUP_TIMESTAMP","DROPOFF_TIMESTAMP" = DBT_INTERNAL_SOURCE."DROPOFF_TIMESTAMP","PICKUP_DATE" = DBT_INTERNAL_SOURCE."PICKUP_DATE","PICKUP_HOUR" = DBT_INTERNAL_SOURCE."PICKUP_HOUR","PICKUP_LOCATION_ID" = DBT_INTERNAL_SOURCE."PICKUP_LOCATION_ID","PICKUP_ZONE_SK" = DBT_INTERNAL_SOURCE."PICKUP_ZONE_SK","DROPOFF_LOCATION_ID" = DBT_INTERNAL_SOURCE."DROPOFF_LOCATION_ID","DROPOFF_ZONE_SK" = DBT_INTERNAL_SOURCE."DROPOFF_ZONE_SK","PASSENGER_COUNT" = DBT_INTERNAL_SOURCE."PASSENGER_COUNT","TRIP_DISTANCE_MILES" = DBT_INTERNAL_SOURCE."TRIP_DISTANCE_MILES","TRIP_DURATION_MINUTES" = DBT_INTERNAL_SOURCE."TRIP_DURATION_MINUTES","FARE_AMOUNT" = DBT_INTERNAL_SOURCE."FARE_AMOUNT","TIP_AMOUNT" = DBT_INTERNAL_SOURCE."TIP_AMOUNT","TOLLS_AMOUNT" = DBT_INTERNAL_SOURCE."TOLLS_AMOUNT","EXTRA_AMOUNT" = DBT_INTERNAL_SOURCE."EXTRA_AMOUNT","IMPROVEMENT_SURCHARGE" = DBT_INTERNAL_SOURCE."IMPROVEMENT_SURCHARGE","MTA_TAX" = DBT_INTERNAL_SOURCE."MTA_TAX","CONGESTION_SURCHARGE" = DBT_INTERNAL_SOURCE."CONGESTION_SURCHARGE","AIRPORT_FEE" = DBT_INTERNAL_SOURCE."AIRPORT_FEE","TOTAL_AMOUNT" = DBT_INTERNAL_SOURCE."TOTAL_AMOUNT","PAYMENT_TYPE_CODE" = DBT_INTERNAL_SOURCE."PAYMENT_TYPE_CODE","PAYMENT_TYPE_SK" = DBT_INTERNAL_SOURCE."PAYMENT_TYPE_SK","RATE_CODE_ID" = DBT_INTERNAL_SOURCE."RATE_CODE_ID","RATE_CODE_SK" = DBT_INTERNAL_SOURCE."RATE_CODE_SK","VENDOR_ID" = DBT_INTERNAL_SOURCE."VENDOR_ID","VENDOR_SK" = DBT_INTERNAL_SOURCE."VENDOR_SK","TRIP_TYPE_CODE" = DBT_INTERNAL_SOURCE."TRIP_TYPE_CODE","AVERAGE_SPEED_MPH" = DBT_INTERNAL_SOURCE."AVERAGE_SPEED_MPH","WAS_STORE_AND_FORWARD" = DBT_INTERNAL_SOURCE."WAS_STORE_AND_FORWARD","EHAIL_FEE" = DBT_INTERNAL_SOURCE."EHAIL_FEE","DRIVER_PAY" = DBT_INTERNAL_SOURCE."DRIVER_PAY","HVFHS_LICENSE_NUM" = DBT_INTERNAL_SOURCE."HVFHS_LICENSE_NUM","DISPATCHING_BASE_NUM" = DBT_INTERNAL_SOURCE."DISPATCHING_BASE_NUM","ORIGINATING_BASE_NUM" = DBT_INTERNAL_SOURCE."ORIGINATING_BASE_NUM","SHARED_REQUEST_FLAG" = DBT_INTERNAL_SOURCE."SHARED_REQUEST_FLAG","SHARED_MATCH_FLAG" = DBT_INTERNAL_SOURCE."SHARED_MATCH_FLAG","ACCESS_A_RIDE_FLAG" = DBT_INTERNAL_SOURCE."ACCESS_A_RIDE_FLAG","WAV_REQUEST_FLAG" = DBT_INTERNAL_SOURCE."WAV_REQUEST_FLAG","WAV_MATCH_FLAG" = DBT_INTERNAL_SOURCE."WAV_MATCH_FLAG","RECORD_LOADED_AT" = DBT_INTERNAL_SOURCE."RECORD_LOADED_AT","DW_LOAD_TS" = DBT_INTERNAL_SOURCE."DW_LOAD_TS"
    

    when not matched then insert
        ("TRIP_SK", "SERVICE_TYPE", "PICKUP_TIMESTAMP", "DROPOFF_TIMESTAMP", "PICKUP_DATE", "PICKUP_HOUR", "PICKUP_LOCATION_ID", "PICKUP_ZONE_SK", "DROPOFF_LOCATION_ID", "DROPOFF_ZONE_SK", "PASSENGER_COUNT", "TRIP_DISTANCE_MILES", "TRIP_DURATION_MINUTES", "FARE_AMOUNT", "TIP_AMOUNT", "TOLLS_AMOUNT", "EXTRA_AMOUNT", "IMPROVEMENT_SURCHARGE", "MTA_TAX", "CONGESTION_SURCHARGE", "AIRPORT_FEE", "TOTAL_AMOUNT", "PAYMENT_TYPE_CODE", "PAYMENT_TYPE_SK", "RATE_CODE_ID", "RATE_CODE_SK", "VENDOR_ID", "VENDOR_SK", "TRIP_TYPE_CODE", "AVERAGE_SPEED_MPH", "WAS_STORE_AND_FORWARD", "EHAIL_FEE", "DRIVER_PAY", "HVFHS_LICENSE_NUM", "DISPATCHING_BASE_NUM", "ORIGINATING_BASE_NUM", "SHARED_REQUEST_FLAG", "SHARED_MATCH_FLAG", "ACCESS_A_RIDE_FLAG", "WAV_REQUEST_FLAG", "WAV_MATCH_FLAG", "RECORD_LOADED_AT", "DW_LOAD_TS")
    values
        ("TRIP_SK", "SERVICE_TYPE", "PICKUP_TIMESTAMP", "DROPOFF_TIMESTAMP", "PICKUP_DATE", "PICKUP_HOUR", "PICKUP_LOCATION_ID", "PICKUP_ZONE_SK", "DROPOFF_LOCATION_ID", "DROPOFF_ZONE_SK", "PASSENGER_COUNT", "TRIP_DISTANCE_MILES", "TRIP_DURATION_MINUTES", "FARE_AMOUNT", "TIP_AMOUNT", "TOLLS_AMOUNT", "EXTRA_AMOUNT", "IMPROVEMENT_SURCHARGE", "MTA_TAX", "CONGESTION_SURCHARGE", "AIRPORT_FEE", "TOTAL_AMOUNT", "PAYMENT_TYPE_CODE", "PAYMENT_TYPE_SK", "RATE_CODE_ID", "RATE_CODE_SK", "VENDOR_ID", "VENDOR_SK", "TRIP_TYPE_CODE", "AVERAGE_SPEED_MPH", "WAS_STORE_AND_FORWARD", "EHAIL_FEE", "DRIVER_PAY", "HVFHS_LICENSE_NUM", "DISPATCHING_BASE_NUM", "ORIGINATING_BASE_NUM", "SHARED_REQUEST_FLAG", "SHARED_MATCH_FLAG", "ACCESS_A_RIDE_FLAG", "WAV_REQUEST_FLAG", "WAV_MATCH_FLAG", "RECORD_LOADED_AT", "DW_LOAD_TS")

;
    commit;